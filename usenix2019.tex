% TEMPLATE for Usenix papers, specifically to meet requirements of
%  USENIX '05
% originally a template for producing IEEE-format articles using LaTeX.
%   written by Matthew Ward, CS Department, Worcester Polytechnic Institute.
% adapted by David Beazley for his excellent SWIG paper in Proceedings,
%   Tcl 96
% turned into a smartass generic template by De Clarke, with thanks to
%   both the above pioneers
% use at your own risk.  Complaints to /dev/null.
% make it two column with no page numbering, default is 10 point

% Munged by Fred Douglis <douglis@research.att.com> 10/97 to separate
% the .sty file from the LaTeX source template, so that people can
% more easily include the .sty file into an existing document.  Also
% changed to more closely follow the style guidelines as represented
% by the Word sample file. 

% Note that since 2010, USENIX does not require endnotes. If you want
% foot of page notes, don't include the endnotes package in the 
% usepackage command, below.

% This version uses the latex2e styles, not the very ancient 2.09 stuff.

% Updated July 2018: Text block size changed from 6.5" to 7"

\documentclass[letterpaper,twocolumn,10pt]{article}
\usepackage{usenix2019,epsfig,endnotes}
\begin{document}

%don't want date printed
\date{}

%make title bold and 14 pt font (Latex default is non-bold, 16 pt)
\title{\Large \bf Hacking Electronic Internet Connected Shifters }

%for single author (just remove % characters)
\author{
  {\rm Thomas Hansen}\\
  UW Madison
  \and
  {\rm Tolga Beser}\\
  UW Madison
  \and
  {\rm Chang-Yen Tseng}\\
  UW Madison
  % copy the following lines to add more authors
  % \and
  % {\rm Name}\\
  %Name Institution
} % end author

\maketitle

% Use the following at camera-ready time to suppress page numbers.
% Comment it out when you first submit the paper for review.
\thispagestyle{empty}


\subsection*{Abstract}


\section{Introduction}

% A paragraph of text goes here.  Lots of text.  Plenty of interesting text. \\

% More fascinating text. Features\endnote{Remember to use endnotes, not footnotes!} galore, plethora of promises.\\

Cyclists has seen the emergence of wireless shifting technologies over the past few years. While the technology existed as far back as the 1990s, adoption has accelerated in recent years, especially for high-end bikes. As we see the technology improve, these shifters have become faster and more precise than mechanical shifting, accelerating their adoption among riders.

The wireless shifters use an assortment of communication technologies known as Personal Area Networks (PAN’s) such as Bluetooth. The use of these technologies opens the once closed off bicycle to security vulnerabilities. If an attacker can trigger extraneous shifts the cyclist can be thrown off their bike causing personal injury and the potential for even larger accidents (cyclists in pro races are tightly packed causing crashes to spread quickly). While security research focused on these electronic shifters is sparse there exists a plethora of work exploring security for various Personal Area Network enabled devices. A subset of wireless shifters utilizes Bluetooth as a communication protocol which has been shown to have security flaws in several implementations. One of the wireless shifting devices that we would like to examine is the SRAM eTAP system which utilizes their novel Airea Personal Area Network protocol which allows their components to communicate from up to a hundred meters away. This large distance could allow an attacker to communicate with their components from an unobservable location.

\section{Related Work}

There has been a lot of work into researching how to break wireless networks on embedded electronic devices, especially those where security is not the strong suit. Many simply use replay attacks and exploit design flaws with device authentication~\cite{Halperin}. Other paper look broadly on the state of wireless security, and analyse methods surrounding IoT devices and wireless communication methods~\cite{Choi}~\cite{Radek}.

We attempted to take many of these findings and bring them to the electronic shifting space, and see what sorts of vulnerabilities we could find. To the best of our knowledge, no comprehensive research yet has existed on the security wireless shifters for bikes. We studied the Archer Components DX1, SRAM eTap, and Shimano Di2 for vulnerabilities.

\section{Potential Impact}

Electronic shifters in bikes have become extremely popular among high-end bikes. Tadej Pogačar, the overall winner of the 2021 and 2020 tour won using a Campagnolo EPS shifter. Egan Bernal, the 2019 winner, won riding a Pinarello that used Shimano Dura Ace Di2 shifters~\cite{GCNTech}. Furthermore high-end bikes, such as the Trek Madone 9, are sold by defualt with electronic shifters.

Competitions furthermore have high stakes. The Tour de France prize pool is 3.6 million AU, and many millions stand to be gained from partnerships and sponsors. Anyone who's able to impact a race in their favor may realize substantial financial gain, and we only expect the potential professional impact to expand with time.

Lastly is the impact on line. Biking is a sport where even more casual riders will go for hours, and being able to disable a bike and strand someone somewhere can make them more vulnerable or otherwise threaten their wellbeing. It's because of all of these reasons we think the security of electronic shifters is an important topic that deserves research.

\subsection{Contributions}

Our major contribution to the field was bringing proper security testing to electronic sifters in the biking industry. These devices have become increasingly popular among professionals and performance cyclists, and there's no real analysis of which devices provide the best, if any, security to the biker.

Some devices, like the STRAM eTap, claim

\subsection{Common Attacks Against IoT Devices}

The security of IoT Devices is well documented and various devices have been studied in recent years. [cite papers here] Because the research body is so vast we will derive a few common attack vectors. The attack vectors that we will outline are Replay Attacks[cite], Denial of Service[cite], and Man in the Middle Attacks[cite].
\\\\
(1) Replay Attacks are conducted by recording communication signals between IoT Devices and replaying them. Without a dynamic key(not sure if this wording is right) these false signals will be non-discernible from the legitimate commands. [cite] \\
(2) Denial of Service(DDOS) attacks have been shown to be effective against a variety of IoT devices. Lack of processing power among small IoT devices compounds their risks to such attacks. [cite] \\
(3) Man in The Middle(MITM) attacks intercept communications from IoT devices and proceed to act as the expected receiver/communicator.[cite]\\


\subsection{Research in wireless attacks against other vehicles}


% \section{Threat Model}

\section{Devices}
\subsection{Archer Components D1X}

The Archer D1X is a modular electronic shifting system that can be integrated into a wide array of derailleur-shifting groupsets. While the other two components groups that we study come with custom derailleurs that are wirelessly enabled the D1X focuses on integrating into existing systems. It is installed near the derailleur with the shifting cables routing through it. This allows the D1X to change the tensions of the shifting cables and therefore the gears. The electronic shifting box is wirelessly connected to the bluetooth enabled hand shifters which allow the users to send shifting signals. Of note, the D1X is the only component that we will study that utilizes the bluetooth protocol for communication between shifter and shifting box (akwardly worded need to change).

The setup for the D1X is largely influenced by the bluetooth protocol (probably cite here). On first use, both the shifter and the shifting box need to be turned on with the power button pressed for specific lengths of time (fact check this). This allows the components to go through a one time pairing process, subsequent uses do not require this step. The user can also connect to the shifting box with their smartphone using the Archer mobile application. This is done by turning on the shifting box and going to the Archer application to pair (fact check if we press another button). Through the application the user can set shifting profiles allowing them to dictate specific gears that should be changed upon a shifting command. (Didn't want to talk about connection vulnerability here)

\subsection{Shimano Di2}


\subsection{SRAM Force eTap AXS}
The SRAM Force eTap AXS \cite{etap} is marketed toward professional, competitive bikers, and is price most premium out of all of our components. It works completely wirelessly like the Archer Components DX1, where there is no need for physical wire between the derailleur and the shifters. The SRAM is also the only one in our lineup that uses a proprietary protocol. The derailleur and the shifter communicate using the in-house AIREA protocol that operates within the 2.475Ghz frequency range. The system also provides Bluetooth for connecting to a smartphone and ANT+ to send information to a bicycle computer.

To set up the SRAM system, the biker will have to click a button on the derailleur to enter pairing mode and then click the buttons on both shifters consecutively to finish the pairing process. To connect to a mobile phone, the biker will start an app on their phone, select their SRAM system, and long-press a button on the derailleur to authorize. Note that the app provides ways to remap each shifter to different operations (gear up, gear down), but the user is not able to shift the gear directly in the app.




\section{Security Analysis}



\subsection{Threat Model \& Goal}
We want to protect the safety of the bikers with such electronic shifters as sudden shifting when unintended may cause massive harm. We assume a scenario where bikers are joined with some malicious actors in a large-scale biking competition. In this scenario, we assume the adversary has access to the type of shifter the victim is using. The adversary can also be in close proximity with the victim before or during the competition, as a result, they can send arbitrary radio signals to the victim. We further assume the adversary can have a very short period of physical access with the victim's bike before the competition, such as when the victim is not looking.

We define a successful attack as making a victim's bike shift to an unintended gear during the competition. We assume all competitors will do a quick test ride before the competition and don't consider denial of service before the competition as a successful attack since this does not introduce safety risks to the riders. For that reason, simple attacks such as cutting the victim's breaking cable or poking a hole in the victim's tire will be trivially easy to spot during the test ride and thus won't qualify as a successful attack.


\subsection{Bluetooth Pairing Weekness}


\subsection{SRAM Replay Attack}



\section{Evaluation}


\section{Recommendations}


\section{Conclusions}




\section{Future Work}




 {\normalsize \bibliographystyle{acm}
  \bibliography{references}}

% \theendnotes

\end{document}


% Some embedded literal typset code might 
% look like the following :

% {\tt \small
% \begin{verbatim}
% int wrap_fact(ClientData clientData,
%               Tcl_Interp *interp,
%               int argc, char *argv[]) {
%     int result;
%     int arg0;
%     if (argc != 2) {
%         interp->result = "wrong # args";
%         return TCL_ERROR;
%     }
%     arg0 = atoi(argv[1]);
%     result = fact(arg0);
%     sprintf(interp->result,"%d",result);
%     return TCL_OK;
% }
% \end{verbatim}
% }

% you can also use the wonderful epsfig package...
% \begin{figure}[t]
% \begin{center}
% \begin{picture}(300,150)(0,200)
% \put(-15,-30){\special{psfile = images/piezospeaker.png hscale = 50 vscale = 50}}
% \end{picture}\\
% \end{center}
% \caption{Wonderful Flowchart}
% \end{figure}


% Example image
% \begin{figure}[ht]
% \begin{center}
% \centering
% \includegraphics[width=0.4\textwidth]{images/2msSig18.png}
%
% \label{fig:2msSignal}
% \end{center}
% \caption{Above is a signal generated with data, where each bit was transmitted over 2ms. This allowed us % to create high resolution bit maps where the bits are distinguishable from each other.}
% \end{figure}


% An example table if we need to display data
%
% \begin{table}[]
% \begin{tabular}{|l|l|r|}
% \hline
% \multicolumn{1}{|c|}{Action}        & Code   & Distance                      \\ \hline
% Right turn                          & 0b0001    &                               \\ \hline
% Left turn                           & 0b0010   &                               \\ \hline
% Change lane (right)                 & 0b0011   &                               \\ \hline
% Change lane (left)                  & 0b0100  &                               \\ \hline
% Merge (right)                       & 0b0101  &                               \\ \hline
% Merge (left)                        & 0b0110  &                               \\ \hline
% Offramp                             & 0b0111  & \multicolumn{1}{l|}{}         \\ \hline
% Temporarily change lanes (incident) & 0b1000 & \multicolumn{1}{l|}{}         \\ \hline
% Speed (speeding up)                 & 0b1001 & \multicolumn{1}{l|}{Not used} \\ \hline
% Speed (slowing down)                & 0b1010 & \multicolumn{1}{l|}{Not used} \\ \hline
% \end{tabular}
% \end{table}



% Itemized list example
%
% \begin{itemize}
% \item Example itemized list
% \item Item 2
% \end{itemize}


% Equation Example:
% 
% $$ f = f_{0} \frac{c \pm v_{r}}{c \pm v_{t}} $$


% Example Code
%
% {\tt \small
% \begin{verbatim}

% generateSignal(dataSet)
%     lf = rand_low_freq
%     hf = rand_low_freq + frequency_shift

%     bits = [1,0,1,0,0,1,dataSet]
%     freqs = ones(length(bits)) .* lf

%     % assign 1 bits to high frequency
%     for 1 = 1:length(bits)
%         if bits(i) == 1
%             freqs(i) = hf
%         end
%     end

%     % add frequencies to signal
%     for i = 1:length(packet)
%         t = 0:1/fs:bit_duration;
%         f = sin(2*pi*packet(i).*t + phase);

%         % update phase
%         phase = phase + 2*pi*packet(i)*bit_duration;

%         % add in next position
%         ff(start_leg:end_leg) = f;
%     end
% end
% \end{verbatim}}
